## Introduction to MRI in cognitive neuroscience

![](images/claus_7TCOR_activity_website.png)

::: notes
:::

## fMRI in comparison

![](images/clipboard-2571024653.png)

Source: Gazzaniga 5th edition, Figure 3.45

::: notes
:::

## Basis of fMRI

![](images/clipboard-4003227498.png)

## Analysis steps (most modalities modalities)

Deriving some subject-level measures (aka dependent variables), e.g. thickness, activation, connectivity, FA

Compensating for artifacts Correcting for subject movement Normalization (mapping to template space) Smoothing: increases SNR

Analysis of your subject sample, e.g. comparison of within-subject conditions, group comparison, regression/correlation with behavior

Compensating for alpha error (false positives) inflation due to many dependent variables: n voxels, n tracts, n connections, etc.

::: notes
:::

## Motion correction/coregistration

Purpose: compensate for subject movement

::: notes
One of the first preoprocessign steps is motion correction. Why do we need motion correction? During the fMRI experiment the subject is supposed to lay still inside the scanner, and they usually do so. However, even your best volunteer won’t be perfect. And in fMRI, even a frew millimeters screw up your experiemnt. Here is an example. Let’s say we are measuring a voxel located on the left hemishere, and the subject suddently moved. As a result, the same voxel will be now recording activity from the empty space between the hemispheres, or even form the opposite hemisphere.
:::

## Motion correction

# volume

6 parameter “rigid body” transform

3x

3x

Purpose: compensate for subject movement

![Slide Image](images/slide_4_img.png)

::: notes
Usually, motion is much smaller, but we still want to correct it. How do we do this? Luckily there are special angorythms that can estimate the amoutnt of motion from one volume to the next. This is usally done using 6 degrees of freedom: trhasnlation in x, y, and z and rotation in x, y, and z. This is called the rigid body transform, because you do not change the size and shape of the volume, but simply rotate it in space. After the amount of motion has been calculated, it can be applied to every image to align it back to the necessary position.
:::

## “Normalization” to common space

http://publicdomainreview.org/collections/phrenology-diagrams-from-vaughts-practical-character-reader-1902/

Purpose 1: compensate individual differences in brain shape for the group analysis

::: notes
Finally, if you are preforming a group study, you also need to map each individual subject into some common space. This is not a trivial task. As head shpaes of people are different, there brain shapes are also different. Here I tried to draw the approximate shape if each of these guy’s brains, and some hypotheitcal template brain.
:::

## Templates & coordinate systems

Talairach

http://imaging.mrc-cbu.cam.ac.uk/imaging/MniTalairach

MNI

Purpose 2: Unified coordinate system

::: notes
:::

## Template

Rigid transform

6 parameter rigid transform

3x

3x

![Slide Image](images/slide_7_img.png)

![Slide Image](images/slide_7_img.png)

::: notes
To match each of them to the template, it is not enough to coregister them as we did for motion correction, because obviously they are of different sizes
:::

## Affine transform

12 parameter affine transform

3x

3x

3x

3x

![Slide Image](images/slide_8_img.png)

![Slide Image](images/slide_8_img.png)

::: notes
We can add 6 more paraeters to the transform, which compensates does scaling and shearing, to better align them. However, there will still be places wehere they do not align perfectly, because one guy one has a bigger frontal lobe, and gy to a bigger parietal lobe
:::

## Nonlinear transform

“warping”

Source

Deformation field

Warped image

Template

![Slide Image](images/slide_9_img.png)

![Slide Image](images/slide_9_img.png)

::: notes
So some software packages use a nonlinear warping algorythm to align brains. There you have to estimate a 3D deformation field and then nonlinearly warp each brain onto a template. They are called non-linear, because different parts of the volume are scaled differently.
:::

## Normalization is usually done using a structural scan

::: notes
The mapping to common space is usally done via an anatomical scan. First, each subject functional and anatomical scans are coregistered with each other, and then each subject’s anatomical scan is mapped into a template. This is done because the anatomical scan has better quality, and hence the estimated transform is more preceise. After you have done that each area in one subject corresponds to the same area in the other subject and you can perform averaging on them.
:::

## Multiple comparison correction

t = β/SE(β)

Thresholding: deal with the multiple comparison problem!

72,221 voxels

![Slide Image](images/slide_11_img.png)

![Slide Image](images/slide_11_img.png)

![Slide Image](images/slide_11_img.png)

::: notes
How do we get from beta estimates to making statistical inference? Rejecting the null hypothesis? The good thing is that beta estimated devided by its standard eroor is a t-statistic with a t-distribution. So to know wheter an activation in one voxel is significant is relatively straifhtforward. If we had just one voxel, we would have computed the t-statistic, and then depending on the degrees of freedom determined if it exceeds the critical value. However, we are doing the same statistical test for MANY voxels. SO the probability that we find a significant voxel simply by chance increases. This is the multiple comparison problem that is encountered anywhere in statistics. In fMRI it is particularly prominent, because the number if singe tests is enormous. There are several ways and philosophies for dealign with it, I won’t go into details right now. The important thing is that any voxel wise analysis MUST deal with this problem in some way.
:::

## SPM: Family-Wise Error (FWE)

“soft” Bonferroni correction Based on Gaussian Random Field Theory Assumes spatial Gaussian distribution voxel values Threshold adjustment controls the probability (e.g. p\<0.05 ) of false positive blobs (“resels”) instead of false positive voxels

SPM{t}

For some more maths and explanations see: http://imaging.mrc-cbu.cam.ac.uk/imaging/PrinciplesRandomFields#The_multiple_comparison_problem

![Slide Image](images/slide_12_img.png)

![Slide Image](images/slide_12_img.png)

![Slide Image](images/slide_12_img.png)

::: notes
Determine n resels (related to smoothness, Smoothness is determined from the covariance of the residulas (remaining signal that is not modelled in your GLM)) Determine Expected Euler characteristic of an image when thresholded at different levels (EC – roughly number of blobs after thresholding, complicated formula, but depends on the number of resels) Use Euler characteristic distribution to determine the threshold for required fals-positive probability (e.g. 0.05)

SPM likes to use a method called family-wise error correction; In principle, it can be viewed as kind of soft bonferronly correciton, but with the way more complicated math gehind it called the gaussian random field theory. The main idea behind this method is that a value in each voxel is not independent from it’s neigbours. And you can see that it is true, especially when the data has been smoothed, or t-map values vary smoothly across the brain volume. So instead of figureing out the threshold such that the number of false poistive voxels is kept at a certain leve, e.g. 0.05, it tries to figure out how many false positive blobs you will get.
:::

## FS-FAST: Montecarlo-based cluster-wise correction

True activations tend to cluster Threshold a map at some p-value Generate random noise, analyze it like real data, get maximal cluster size Repeat many times and get a distribution of maximal cluster sizes observed in noise Compare each of your real clusters to the distribution P(cluster) = probability of seeing a maximum cluster of that size or larger in noise

p\<.0001

Unthresholded

https://surfer.nmr.mgh.harvard.edu/fswiki/FsTutorial/GroupAnalysis#ClusterwiseCorrectionforMultipleComparisons

mri_glmfit-sim

![Slide Image](images/slide_13_img.png)

![Slide Image](images/slide_13_img.png)

![Slide Image](images/slide_13_img.png)

![Slide Image](images/slide_13_img.png)

::: notes
FDR: proportion of false positives rather than probability of AT LEAST ONE false positive
:::

## Multiple comparison correction

Avoid it if you can by formulation a specific hypothesis

::: notes
:::
